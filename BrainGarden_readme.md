# Решение для повышения фотореализма

## Подготовка данных

Требуются последовательности данных (кадры видео).
Необходимо подготовить две папки: с данными для обучения (`<train_dir> `) и данными для валидации (`<val_dir>`).
Каждая папка `<train_dir> ` или `<val_dir>` содержит две подпапки: `real` и `virtual`. Каждая из подпапок имеет одинаковую структуру:
```
<dataset_dir>                       <real/virtual dir>
    ├- <train_dir>                      ├- <video1_name>
    │   ├- real                         │   ├- frames
    │   └- virtual                      │   ├- <modality1_name>
    └- <val_dir>                        │   ├- <modality2_name>
        ├- real                         │   ...
        └- virtual                      │   └- <modalityN_name>
                                        ├- <video2_name>
                                        │   ├- frames
                                        │   ├- <modality1_name>
                                        │   ...
                                        │   └- <modalityN_name>
                                       ...  ...
                                        └- <videoN_name>
                                            ├- frames
                                            ├- <modality1_name>
                                            ...
                                            └- <modalityN_name>
```
- `frames` - это кадры видео (должны быть без пропусков, имена файлов позволяют отсортировать их по порядку)

- `<modalityX_name>` - это папка с обработанными кадрами видео (имена должны быть теми же): это могут быть сегментационные маски, размытые изображения и т.д.

## Подготовка конфигурационного файла для обучения
Для каждой сессии (запуска) обучения создаётся папка `<run_dir>`, в которую помещается конфигурационный файл `<cfg>.yaml`.

В данном репозитории есть примеры конфиг-файлов: experiments_multimodal

Подробное описание конфигурационного файла здесь. <- TODO

## Запуск обучения
Создав папку для текущего запуска обучения `<run_dir>` и в ней - конфигурационный файл `<cfg>.yaml`, обучение запускается следующей командой (терминал запущен из корня проекта):
```
CUDA_VISIBLE_DEVICES=<1> python codes/main.py --exp_dir <2> --mode train --model TecoGAN --opt <3> --gpu_id 0
```
- `<1>`: номер видеокарты, на которой запускается обучение
- `<2>`: папка для текущей сессии обучения `<run_dir>`
- `<3>`: имя конфиг-файла `<cfg>.yaml`

## Выполнение вывода (предсказаний)
TODO